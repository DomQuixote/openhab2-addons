<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                          xmlns:thing="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0"
                          xmlns:thing-description="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0"
                          xmlns:config-description="http://eclipse.org/smarthome/schemas/config-description/v1.0.0"
                          bindingId="network"
                          xsi:schemaLocation="http://eclipse.org/smarthome/schemas/thing-description/v1.0.0 http://eclipse.org/smarthome/schemas/thing-description-1.0.0.xsd">
   <thing-type id="0">
      <supported-bridge-type-refs>
         <bridge-type-ref id="lwm2mBridgeThing"/>
      </supported-bridge-type-refs>
      <label>LWM2M Security</label>
      <description><![CDATA[This LWM2M Object provides the keying material of a LWM2M Client appropriate to access a specified LWM2M Server. One Object Instance SHOULD address a LWM2M Bootstrap Server.    These LWM2M Object Resources MUST only be changed by a LWM2M Bootstrap Server or Bootstrap from Smartcardand MUST NOT be accessible by any other LWM2M Server.==E.1.1	UDP Channel Security: Security Key Resource Format==This section defines the format of the Secret Key and Public Key and Identity Resources of the LWM2M Server and LWM2M Bootstrap Objects when using UDP Channel security. These Resources are used to configure the security mode and keying material that a Client uses with a particular Server. The Objects are configured on the Client using one of the Bootstrap mechanisms described in Section 5.1. The use of this keying material for each security mode is defined in Section 7.1.==E.1.1.1	Pre-Shared Key (PSK) Mode==The PSK is a binary shared secret key between the Client and Server of the appropriate length for the Cipher Suite used [RFC4279]. This key is composed of a sequence of binary bytes in the Secret Key Resource. The default PSK Cipher Suites defined in this specification use a 128-bit AES key. Thus this key would be represented in 16 bytes in the Secret Key Resource.The corresponding PSK Identity for this PSK is stored in the Public Key or Identity Resource. The PSK Identity is simply stored as a UTF-8 String as per [RFC4279]. Clients and Servers MUST support a PSK Identity of at least 128 bytes in length as required by [RFC4279].==E.1.1.2	Raw-Public Key (RPK) Mode==The raw-public key mode requires a public key and a private key of the appropriate type and length for the Cipher Suite used. These keys are carried as a sequence of binary bytes with the public key stored in the Public Key or Identity Resource, and the private key stored in the Secret Key Resource. The default RPK Cipher Suites defines in this specification use a 256-bit ECC key. Thus the Certificate Resource would contain a 32 byte public key and the Secret Key Resource a 32 byte private key.==E.1.1.3	Certificate Mode==The Certificate mode requires an X.509v3 Certificate along with a matching private key. The private key is stored in the Secret Key Resource as in RPK mode. The Certificate is simply represented as binary X.509v3 in the value of the Public Key or Identity Resource.==E.1.2	SMS Payload Security: Security Key Resource Format==This section defines the format of the Secret Key and Public Key and Identity resources of the LWM2M Server and LWM2M Bootstrap Objects when using SMS Payload security. These resources are used to configure keying material that a Client uses with a particular Server. The Objects are configured on the Client using one of the Bootstrap mechanisms described in Section 5.1. The use of this keying material is defined in Section 7.2.The SMS key parameters are stored in the order KIc, KID, SPI, TAR (KIc is byte 0).Ordering of bits within bytes SHALL follow ETSI TS 102 221, section 3.4 “Coding Conventions” (b8 MSB, b1 LSB).==E.1.3	Unbootstrapping==Unbootstrapping is the process of deleting a Security Object Instance. If a Security Object Instance is to be deleted, certain related resources and configurations need to be deleted or modified. Therefore, when the Delete operation is sent via the Bootstrap Interface, the Client MUST execute the following procedure.#If there is an Object Instance that can be accessed only by a Server of the Server Object Instance (i.e., the Server is Access Control Owner and the LWM2M Server can access the Object Instance only in an Access Control Object Instance), the Object Instance and the corresponding Access Control Object Instance MUST be deleted#If an Object Instance can be accessed by multiple Servers including the Server which Security Object Instance is to be deleted, then:- The ACL Resource Instance for the Server in the Access Control Object Instance for the Object Instance MUST be deleted- If the Server is the Access Control Owner of the Access Control Object Instance, then the Access Control Owner MUST be changed to another Server according to the rules below:The Client MUST choose the Server who has highest sum of each number assigned to an access right (Write: 1, Delete: 1) for the Access Control Owner. If two or more Servers have the same sum, the Client MUST choose one of them as the new Access Control Owner.#Observation operations from the Server MUST be deleted#Server Object Instance MUST be deleted#Client MAY send “De-register” operation to the ServerNote: To monitor the change of the Access Control Owner, the Server MAY observe Access Control Owner Resource.]]></description>
      <channels>
         <channel id="LWM2MServerURI" typeId="0"/>
         <channel id="BootstrapServer" typeId="1"/>
         <channel id="SecurityMode" typeId="2"/>
         <channel id="PublicKeyorIdentity" typeId="3"/>
         <channel id="ServerPublicKeyorIdentity" typeId="4"/>
         <channel id="SecretKey" typeId="5"/>
         <channel id="SMSSecurityMode" typeId="6"/>
         <channel id="SMSBindingKeyParameters" typeId="7"/>
         <channel id="SMSBindingSecretKeys" typeId="8"/>
         <channel id="LWM2MServerSMSNumber" typeId="9"/>
         <channel id="ShortServerID" typeId="10"/>
         <channel id="ClientHoldOffTime" typeId="11"/>
      </channels>
      <properties>
         <property name="ObjectID">0</property>
         <property name="ObjectURN">TBD</property>
         <property name="MultipleInstances">Multiple</property>
         <property name="Mandatory">Mandatory</property>
      </properties>
   </thing-type>
</thing:thing-descriptions>
